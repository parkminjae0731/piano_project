<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Piano Sheet</title>
    <style>
      .staff {
        /* ì•…ë³´ ì „ì²´ ìš”ì†Œ */
        margin: 20px auto; /* ìƒí•˜ë‹¨ 20pxì—¬ë°± */
        position: relative;
        width: 900px; /* ì˜¤ì„ ì§€ì˜ ë„ˆë¹„ 900px */
        height: 100px; /* ì˜¤ì„  í•œ ì¤„ì˜ ë†’ì´ 100px */
      }
      .line {
        /* ì˜¤ì„  ìš”ì†Œ */
        position: absolute;
        width: 100%; /* ìƒìœ„ ìš”ì†Œì¸ satffì˜ ê°€ë¡œê¸¸ì˜ 100%ì¸ ì„ ì˜ ê¸¸ì´ */
        border-bottom: 1px solid rgb(0, 0, 0);
      }
      .line:nth-child(1) {
        top: 20%;
      } /* ì²« ë²ˆì§¸ ì˜¤ì„  */
      .line:nth-child(2) {
        top: 30%;
      } /* ë‘ ë²ˆì§¸ ì˜¤ì„  */
      .line:nth-child(3) {
        top: 40%;
      } /* ì„¸ ë²ˆì§¸ ì˜¤ì„  */
      .line:nth-child(4) {
        top: 50%;
      } /* ë„¤ ë²ˆì§¸ ì˜¤ì„  */
      .line:nth-child(5) {
        top: 60%;
      } /* ë‹¤ì„¯ ë²ˆì§¸ ì˜¤ì„  */

      .note {
        /* ìŒìë¦¬í‘œ ìš”ì†Œ */
        position: absolute;
        font-size: 56px; /* ìŒìë¦¬í‘œ í¬ê¸° */
        top: 10%; /* ìŒìë¦¬í‘œì˜ ê¸°ë³¸ ìœ„ì¹˜ */
        left: 10px; /* ìŒìë¦¬í‘œì˜ ê¸°ë³¸ ìœ„ì¹˜ */
      }
    </style>
    <script>
      // ë†’ì€ ìŒìë¦¬, ë‚®ì€ ìŒìë¦¬ ìƒì„±
      document.addEventListener("DOMContentLoaded", function () {
        var staff = document.querySelector(".staff");

        // ë†’ì€ ìŒìë¦¬í‘œ ì¶”ê°€ ë²„íŠ¼
        var highNoteButton = document.createElement("button");
        highNoteButton.textContent = "ë†’ì€ ìŒìë¦¬í‘œ ì¶”ê°€";
        highNoteButton.addEventListener("click", function () {
          var existingLowNote = document.querySelector(
            '.note[data-type="low"]'
          );
          if (existingLowNote) {
            existingLowNote.remove();
          }

          var existingHighNote = document.querySelector(
            '.note[data-type="high"]'
          );
          if (!existingHighNote) {
            var note = document.createElement("div");
            note.className = "note";
            note.textContent = "ğ„";
            note.setAttribute("data-type", "high");
            note.style.top = "-3%"; // ë†’ì€ ìŒìë¦¬í‘œì˜ ìœ„ì¹˜
            staff.appendChild(note);
          } else {
            existingHighNote.remove();
          }
        });
        document.body.appendChild(highNoteButton);

        // ë‚®ì€ ìŒìë¦¬í‘œ ì¶”ê°€ ë²„íŠ¼
        var lowNoteButton = document.createElement("button");
        lowNoteButton.textContent = "ë‚®ì€ ìŒìë¦¬í‘œ ì¶”ê°€";
        lowNoteButton.addEventListener("click", function () {
          var existingHighNote = document.querySelector(
            '.note[data-type="high"]'
          );
          if (existingHighNote) {
            existingHighNote.remove();
          }

          var existingLowNote = document.querySelector(
            '.note[data-type="low"]'
          );
          if (!existingLowNote) {
            var note = document.createElement("div");
            note.className = "note";
            note.textContent = "ğ„¢";
            note.setAttribute("data-type", "low");
            note.style.top = "0%"; // ë‚®ì€ ìŒìë¦¬í‘œì˜ ìœ„ì¹˜
            staff.appendChild(note);
          } else {
            existingLowNote.remove();
          }
        });
        document.body.appendChild(lowNoteButton);
      });

      // ìŒí‘œ ìƒì„±
      coordinates = [];
      document.addEventListener("DOMContentLoaded", function () {
        var staff = document.querySelector(".staff");

        staff.addEventListener("click", function (event) {
          var x = event.clientX - 10 - staff.getBoundingClientRect().left;
          var y = event.clientY - 60 - staff.getBoundingClientRect().top;

          // x ì¢Œí‘œê°€ 50ë³´ë‹¤ ì‘ìœ¼ë©´ ìŒí‘œ ìƒì„±í•˜ì§€ ì•ŠìŒ
          if (x < 60) {
            return;
          }

          // y ì¢Œí‘œë¥¼ ì¡°ê±´ì— ë”°ë¼ ì„¤ì •
          if (y >= 16.5 && y <= 100) {
            y = 19; // ë¼
          } else if (y >= 11.5 && y <= 16.4) {
            y = 14; // ì‹œ
          } else if (y >= 6.5 && y <= 11.4) {
            y = 9; // ë„
          } else if (y >= 1.5 && y <= 6.4) {
            y = 4; // ë ˆ
          } else if (y >= -3.5 && y <= 1.4) {
            y = -1; // ë¯¸
          } else if (y >= -8.5 && y <= -3.4) {
            y = -6; // íŒŒ
          } else if (y >= -13.5 && y <= -8.4) {
            y = -11; // ì†”
          } else if (y >= -18.5 && y <= -13.4) {
            y = -16; // ë¼
          } else if (y >= -23.5 && y <= -18.4) {
            y = -21; // ì‹œ
          } else if (y >= -28.5 && y <= -23.4) {
            y = -26; // ë„
          } else if (y >= -33.5 && y <= -28.4) {
            y = -31; // ë ˆ
          } else if (y >= -38.5 && y <= -33.4) {
            y = -36; // ë¯¸
          } else if (y >= -43.5 && y <= -38.4) {
            y = -41; // íŒŒ
          } else if (y >= -48.5 && y <= -43.4) {
            y = -46; // ì†”
          }

          // í´ë¦­í•œ ì¢Œí‘œë¥¼ ì„œë²„ë¡œ ì „ì†¡
          fetch("/clicked_coordinates", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ x: x, y: y }),
          });

          // ìŒí‘œ ìƒì„±
          var note = document.createElement("div");
          note.className = "note";
          if (y <= -21) {
            // yê°€ -21ë³´ë‹¤ ì‘ìœ¼ë©´ m.png ìƒì„±
            y += 41;
            note.innerHTML =
              '<img src="/static/m.png"  style="width: 15px; height: auto;">';
          } else {
            // ê·¸ ì™¸ì—ëŠ” ìŒí‘œ ìƒì„±
            note.textContent = "â™ª";
            //â™©
          }
          note.style.position = "absolute";
          note.style.left = x + "px";
          note.style.top = y + "px";
          staff.appendChild(note);

          // í´ë¦­í•œ ì¢Œí‘œë“¤ì„ ì €ì¥í•˜ëŠ” ë°°ì—´ì— ì¶”ê°€
          coordinates.push({ x: x, y: y });
        });

        // ì¶œë ¥ ë²„íŠ¼ í´ë¦­ ì‹œ ì„œë²„ë¡œë¶€í„° ì¢Œí‘œ ë°›ì•„ì™€ ì¶œë ¥
        var printButton = document.getElementById("printButton");
        printButton.addEventListener("click", function () {
          // ì¢Œí‘œë¥¼ x ì¢Œí‘œ ê¸°ì¤€ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
          coordinates.sort(function (a, b) {
            return a.x - b.x;
          });
          console.log(coordinates)
          // ì •ë ¬ëœ ì¢Œí‘œ ì¶œë ¥
          coordinates.forEach(function (coord) {
            console.log("Y ì¢Œí‘œ:", coord.y);
          });

          // ì„œë²„ë¡œë¶€í„° ì¢Œí‘œë¥¼ ì„±ê³µì ìœ¼ë¡œ ë°›ì•„ì™”ë‹¤ëŠ” ë©”ì‹œì§€ë¥¼ alertë¡œ ì¶œë ¥
          alert("ì¢Œí‘œë¥¼ ì„±ê³µì ìœ¼ë¡œ ë°›ì•„ì™”ìŠµë‹ˆë‹¤.");
        });
      });
      document.addEventListener("DOMContentLoaded", function () {
    // staff ìš”ì†Œì™€ 4.png ì´ë¯¸ì§€ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
    var staff = document.querySelector(".staff");
    var fourImage = document.querySelector('img[src="/static/4.png"]');

    // staff ìš”ì†Œì—ì„œ ìŒìë¦¬í‘œ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
    var note = document.querySelector('.note[data-type="high"]');
    var notePosition = note.getBoundingClientRect();
    var noteX = notePosition.left;

    // 4.png ì´ë¯¸ì§€ì˜ left ì†ì„± ì„¤ì •í•˜ê¸°
    fourImage.style.left = noteX + "px";
});
    </script>
  </head>
  <body>
    <div class="staff">
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
    </div>
    <button id="printButton">ì¶œë ¥</button>
    <!-- <script>
      document
        .getElementById("printButton")
        .addEventListener("click", function () {
          fetch("/print_coordinates")
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                alert(data.message);
              } else {
                alert("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
              }
            })
            .catch((error) => {
              console.error("Error:", error);
              alert("ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            });
        });
    </script> -->
    <img src="/static/4.png" style="width: 64px;height: auto;position: absolute;left: 55px;top: 3.9%;" />
  </body>
</html>
